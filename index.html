

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ò–ò –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å –º—É–∑—ã–∫–æ–π</title>
    <style>
        body { font-family: Arial; padding: 20px; max-width: 700px; margin: auto; }
        input, select, button { padding: 10px; margin: 5px 0; width: 100%; }
        ul { list-style: none; padding-left: 0; }
        li { padding: 5px 0; border-bottom: 1px solid #ddd; }
    </style>
</head>
<body>
    <h1>–ò–ò –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å –º—É–∑—ã–∫–æ–π</h1>

    <!-- –†—É—á–Ω–æ–π –≤–≤–æ–¥ -->
    <input type="text" id="reminderInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –∑–∞–≤—Ç—Ä–∞ –≤ 18:30 –ø–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ">
    
    <!-- –í—ã–±–æ—Ä –º–µ–ª–æ–¥–∏–∏ -->
    <select id="musicSelect">
        <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3">–ú–µ–ª–æ–¥–∏—è 1</option>
        <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3">–ú–µ–ª–æ–¥–∏—è 2</option>
        <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3">–ú–µ–ª–æ–¥–∏—è 3</option>
    </select>

    <button onclick="addManualReminder()">–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</button>

    <!-- –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ -->
    <button onclick="startListening()">üé§ –ì–æ–≤–æ—Ä–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</button>

    <h2>–°–ø–∏—Å–æ–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π:</h2>
    <ul id="reminderList"></ul>

    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤—Ä–µ–º–µ–Ω–∏ -->
    <script src="https://cdn.jsdelivr.net/npm/chrono-node/dist/chrono.min.js"></script>
    <script>
        let reminders = JSON.parse(localStorage.getItem("reminders") || "[]");

        function saveReminders() {
            localStorage.setItem("reminders", JSON.stringify(reminders));
        }

        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ru-RU';
            speechSynthesis.speak(utterance);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
        function addReminder(text, musicUrl) {
            const parsed = chrono.parseDate(text, new Date(), { forwardDate: true });
            if (!parsed) {
                speak("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è.");
                return;
            }
            reminders.push({ text, time: parsed, music: musicUrl });
            saveReminders();
            updateList();
            speak(`–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–∞ ${parsed.toLocaleString()}`);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é
        function addManualReminder() {
            const input = document.getElementById('reminderInput');
            const select = document.getElementById('musicSelect');
            const text = input.value;
            if (!text) return;
            addReminder(text, select.value);
            input.value = '';
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
        function updateList() {
            const list = document.getElementById('reminderList');
            list.innerHTML = '';
            reminders.forEach((r) => {
                const li = document.createElement('li');
                li.textContent = `${r.text} ‚Äî ${new Date(r.time).toLocaleString()} (–º–µ–ª–æ–¥–∏—è: ${r.music.split('/').pop()})`;
                list.appendChild(li);
            });
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
        function checkReminders() {
            const now = new Date();
            for (let i = reminders.length - 1; i >= 0; i--) {
                if (now >= new Date(reminders[i].time)) {
                    const music = new Audio(reminders[i].music);
                    music.play().then(() => {
                        setTimeout(() => speak(`–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: ${reminders[i].text}`), 3000);
                    }).catch(() => {
                        speak(`–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: ${reminders[i].text}`);
                    });

                    reminders.splice(i, 1);
                    saveReminders();
                    updateList();
                }
            }
        }
        setInterval(checkReminders, 5000);

        // –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥
        function startListening() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRecognition) {
                alert("–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥");
                return;
            }
            const recognition = new SpeechRecognition();
            recognition.lang = 'ru-RU';
            recognition.start();

            recognition.onresult = (event) => {
                const text = event.results[0][0].transcript;
                const select = document.getElementById('musicSelect');
                addReminder(text, select.value);
            };
            recognition.onerror = () => speak("–û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏.");
        }

        updateList();
    </script>
</body>
</html>
